---
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Google Maps API binding for js_of_ocaml - Demo</title>
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/highlight.css">
	</head>
	<body>
		<div id="main"></div>
		<table class="demo">
			<tr class="line">
				<td class="map" id="demo_base_maps"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_base_maps"))
      (fun () -> assert false)
  in
  let options = GoogleMaps.emptyMapOptions() in
  let lat_lng = jsnew GoogleMaps.latLng (Js.number_of_float (-34.397), Js.number_of_float 150.644, Js._false) in
  let () = options##center <- lat_lng in
  let () = options##scrollwheel <- Js._false in
  let () = options##zoom <- Js.number_of_float 8. in
  jsnew GoogleMaps.map(element, options)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_styled_maps"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let styleArray = jsnew Js.array_empty () in

  let style = GoogleMaps.emptyMapTypeStyle () in
  let () = style##featureType <- Js.string "all" in
  let styler = GoogleMaps.emptyMapTypeStyler () in
  let () = styler##saturation <- Js.number_of_float (-80.) in
  let t = jsnew Js.array_empty () in
  let () = Js.array_set t 0 styler in
  let () = style##stylers <- t in
  let () = Js.array_set styleArray 0 style in

  let style = GoogleMaps.emptyMapTypeStyle () in
  let () = style##featureType <- Js.string "road.arterial" in
  let () = style##elementType <- Js.string "geometry" in
  let styler = GoogleMaps.emptyMapTypeStyler () in
  let () = styler##hue <- Js.string "#00ffee" in
  let () = styler##saturation <- Js.number_of_float (50.) in
  let t = jsnew Js.array_empty () in
  let () = Js.array_set t 0 styler in
  let () = style##stylers <- t in
  let () = Js.array_set styleArray 1 style in

  let style = GoogleMaps.emptyMapTypeStyle () in
  let () = style##featureType <- Js.string "poi.business" in
  let () = style##elementType <- Js.string "labels" in
  let styler = GoogleMaps.emptyMapTypeStyler () in
  let () = styler##visibility <- Js.string "off" in
  let t = jsnew Js.array_empty () in
  let () = Js.array_set t 0 styler in
  let () = style##stylers <- t in
  let () = Js.array_set styleArray 2 style in

  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_styled_maps"))
      (fun () -> assert false)
  in
  let options = GoogleMaps.emptyMapOptions() in
  let lat_lng = jsnew GoogleMaps.latLng (Js.number_of_float (-34.397), Js.number_of_float 150.644, Js._false) in
  let () = options##center <- lat_lng in
  let () = options##scrollwheel <- Js._false in
  let () = options##styles <- styleArray in
  let () = options##zoom <- Js.number_of_float 8. in
  jsnew GoogleMaps.map(element, options)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_satellite"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_satellite"))
      (fun () -> assert false)
  in
  let options = GoogleMaps.emptyMapOptions() in
  let lat_lng = jsnew GoogleMaps.latLng (Js.number_of_float (-34.397), Js.number_of_float 150.644, Js._false) in
  let () = options##center <- lat_lng in
  let () = options##scrollwheel <- Js._false in
  let () = options##zoom <- Js.number_of_float 8. in
  let () = options##mapTypeId <- GoogleMaps.mapTypeId##_SATELLITE in
  jsnew GoogleMaps.map(element, options)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_directions"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_directions"))
      (fun () -> assert false)
  in
  let chicago = jsnew GoogleMaps.latLng (Js.number_of_float 41.85, Js.number_of_float (-87.65), Js._false) in
  let indianapolis = jsnew GoogleMaps.latLng (Js.number_of_float 39.79, Js.number_of_float (-86.14), Js._false) in

  let options = GoogleMaps.emptyMapOptions() in
  let () = options##center <- chicago in
  let () = options##scrollwheel <- Js._false in
  let () = options##zoom <- Js.number_of_float 7. in
  let map = jsnew GoogleMaps.map(element, options) in

  let options = GoogleMaps.emptyDirectionsRendererOptions() in
  let () = options##map <- map in
  let directions_display = jsnew GoogleMaps.directionsRenderer(options) in
  let request = GoogleMaps.emptyDirectionsRequest() in
  let place_indianapolis = GoogleMaps.emptyPlace() in
  let () = place_indianapolis##location <- indianapolis in
  let () = request##destination <- place_indianapolis in
  let place_chicago = GoogleMaps.emptyPlace() in
  let () = place_chicago##location <- chicago in
  let () = request##origin <- place_chicago in
  let () = request##travelMode <- GoogleMaps.travelMode##_DRIVING in
  let directions_service = jsnew GoogleMaps.directionsService () in
  let f response status =
    if status = GoogleMaps.directionsStatus##_OK then
      directions_display##setDirections(response)
  in
  directions_service##route(request, Js.wrap_callback f)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_markers"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_markers"))
      (fun () -> assert false)
  in
  let lat_lng = jsnew GoogleMaps.latLng (Js.number_of_float (-25.363), Js.number_of_float 131.044, Js._false) in

  let options = GoogleMaps.emptyMapOptions() in
  let () = options##center <- lat_lng in
  let () = options##scrollwheel <- Js._false in
  let () = options##zoom <- Js.number_of_float 4. in
  let map = jsnew GoogleMaps.map(element, options) in

  let options = GoogleMaps.emptyMarkerOptions() in
  let () = options##map <- map in
  let () = options##position <- lat_lng in
  let () = options##title <- Js.string "Hello World!" in
  jsnew GoogleMaps.marker(options)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_info_window"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_info_window"))
      (fun () -> assert false)
  in
  let uluru = jsnew GoogleMaps.latLng (Js.number_of_float (-25.363), Js.number_of_float 131.044, Js._false) in

  let options = GoogleMaps.emptyMapOptions() in
  let () = options##center <- uluru in
  let () = options##zoom <- Js.number_of_float 4. in
  let map = jsnew GoogleMaps.map(element, options) in

  let content = "<div id=\"content\"> \
    <div id=\"siteNotice\"></div> \
    <h1 id=\"firstHeading\" class=\"firstHeading\">Uluru</h1> \
    <div id=\"bodyContent\"> \
    <p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large  \
    sandstone rock formation in the southern part of the  \
    Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi)  \
    south west of the nearest large town, Alice Springs; 450&#160;km  \
    (280&#160;mi) by road. Kata Tjuta and Uluru are the two major  \
    features of the Uluru - Kata Tjuta National Park. Uluru is  \
    sacred to the Pitjantjatjara and Yankunytjatjara, the  \
    Aboriginal people of the area. It has many springs, waterholes,  \
    rock caves and ancient paintings. Uluru is listed as a World  \
    Heritage Site.</p> \
    <p>Attribution: Uluru, <a href=\"https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194\"> \
    https://en.wikipedia.org/w/index.php?title=Uluru</a>  \
    (last visited June 22, 2009).</p> \
    </div> \
    </div>"
  in

  let options = GoogleMaps.emptyInfoWindowOptions() in
  let () = options##content <- Js.string content in
  let info_window = jsnew GoogleMaps.infoWindow(options) in

  let options = GoogleMaps.emptyMarkerOptions() in
  let () = options##map <- map in
  let () = options##position <- uluru in
  let () = options##title <- Js.string "Uluru (Ayers Rock)" in
  let marker = jsnew GoogleMaps.marker(options) in
  let marker' = (marker :> GoogleMaps._MVCObject Js.t) in

  let f () = info_window##_open(map, marker') in
  marker##addListener(Js.string "click", Js.wrap_callback f)
{% endhighlight %}
				</td>
			</tr>
			<tr class="line">
				<td class="map" id="demo_rectangle_event"></div>
				<td class="code">
{% highlight ocaml %}
let demo doc =
  let element =
    Js.Opt.get (doc##getElementById(Js.string "demo_rectangle_event"))
      (fun () -> assert false)
  in
  let center = jsnew GoogleMaps.latLng(Js.number_of_float 44.5452, Js.number_of_float (-78.5389), Js._false) in

  let options = GoogleMaps.emptyMapOptions() in
  let () = options##center <- center in
  let () = options##zoom <- Js.number_of_float 9. in
  let map = jsnew GoogleMaps.map(element, options) in

  let boundSW = jsnew GoogleMaps.latLng (Js.number_of_float 44.490, Js.number_of_float (-78.649), Js._false) in
  let boundNE = jsnew GoogleMaps.latLng (Js.number_of_float 44.599, Js.number_of_float (-78.443), Js._false) in
  let bounds = jsnew GoogleMaps.latLngBounds(boundSW, boundNE) in
  let options = GoogleMaps.emptyRectangleOptions() in
  let () = options##bounds <- bounds in
  let () = options##editable <- Js._true in
  let () = options##draggable <- Js._true in
  let rectangle = jsnew GoogleMaps.rectangle(options) in
  let () = rectangle##setMap(map) in

  let options = GoogleMaps.emptyInfoWindowOptions() in
  let info_window = jsnew GoogleMaps.infoWindow(options) in

  let show_new_rect(_) =
    let ne = rectangle##getBounds()##getNorthEast() in
    let sw = rectangle##getBounds()##getSouthWest() in
    let ne_lat = ne##lat()##toString() in
    let ne_lng = ne##lng()##toString() in
    let sw_lat = sw##lat()##toString() in
    let sw_lng = sw##lng()##toString() in
    let contentString = "<b>Rectangle moved.</b><br>"
      ^ "New north-east corner: " ^ (Js.to_string ne_lat) ^ ", " ^ (Js.to_string ne_lng) ^ "<br>"
      ^ "New south-west corner: " ^ (Js.to_string sw_lat) ^ ", " ^ (Js.to_string sw_lng)
    in
    let () = info_window##setContent(Js.string contentString) in
    let () = info_window##setPosition(ne) in
    info_window##_open(map, jsnew GoogleMaps.mvcObject())
  in

  rectangle##addListener(Js.string "bounds_changed", Js.wrap_callback show_new_rect)

{% endhighlight %}
				</td>
			</tr>
		</table>
		<script src="https://maps.googleapis.com/maps/api/js"></script>
		<script src="js/main.js"></script>
	</body>
</html>
